{"remainingRequest":"/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!/Users/navyxu/PycharmProjects/ox/frontend/src/views/LoginView.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/navyxu/PycharmProjects/ox/frontend/src/views/LoginView.vue","mtime":1619105869769},{"path":"/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/navyxu/PycharmProjects/ox/frontend/node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9uYXZ5eHUvUHljaGFybVByb2plY3RzL294L2Zyb250ZW5kL25vZGVfbW9kdWxlcy9fQGJhYmVsX3J1bnRpbWVANy4xMy4xN0BAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBwb3N0QXV0aExvZ2luIH0gZnJvbSAnQC9hcGkvbG9naW5BcGknOwppbXBvcnQgc3RvcmFnZSBmcm9tICcuLi91dGlscyc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybTogewogICAgICAgIHVzZXJuYW1lOiAnJywKICAgICAgICBwYXNzd29yZDogJycKICAgICAgfSwKICAgICAgZXJyb3JzOiB7fSwKICAgICAgZm9ybVByb2Nlc3Npbmc6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkgewogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH07CiAgICAgIHJldHVybiBwb3N0QXV0aExvZ2luKGRhdGEpOwogICAgfSwKICAgIG9uU3VibWl0OiBmdW5jdGlvbiBvblN1Ym1pdChldmVudCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgbG9naW5SZXMsIHJlc3VsdCwgYXV0aFRva2VuLCB1c2VyRGF0YSwgdXNlcjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpcy5mb3JtUHJvY2Vzc2luZyA9IHRydWU7CiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2dpbihfdGhpcy5mb3JtLnVzZXJuYW1lLCBfdGhpcy5mb3JtLnBhc3N3b3JkKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgbG9naW5SZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgcmVzdWx0ID0gbG9naW5SZXMuZGF0YTsKICAgICAgICAgICAgICAgIGF1dGhUb2tlbiA9IHJlc3VsdFsnYXV0aF90b2tlbiddOwoKICAgICAgICAgICAgICAgIF90aGlzLiRzdG9yZS5jb21taXQoJ1NFVF9BVVRIX1RPS0VOJywgYXV0aFRva2VuKTsKCiAgICAgICAgICAgICAgICBzdG9yYWdlLnNhdmVBdXRoVG9rZW4oYXV0aFRva2VuKTsKICAgICAgICAgICAgICAgIHVzZXJEYXRhID0gcmVzdWx0LnVzZXI7CiAgICAgICAgICAgICAgICB1c2VyID0gewogICAgICAgICAgICAgICAgICB1c2VySWQ6IHVzZXJEYXRhLmlkLAogICAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlckRhdGEudXNlcm5hbWUsCiAgICAgICAgICAgICAgICAgIG5pY2tuYW1lOiB1c2VyRGF0YS5uaWNrbmFtZQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBfdGhpcy4kc3RvcmUuY29tbWl0KCdTRVRfVVNFUicsIHVzZXIpOwoKICAgICAgICAgICAgICAgIHN0b3JhZ2Uuc2F2ZVVzZXIodXNlcik7CiAgICAgICAgICAgICAgICBfdGhpcy5mb3JtUHJvY2Vzc2luZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICdyb2JvdC1saXN0JwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjY7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxOTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMik7CgogICAgICAgICAgICAgICAgaWYgKF9jb250ZXh0LnQwLnJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgIGlmIChfY29udGV4dC50MC5yZXNwb25zZS5zdGF0dXMgPj0gNTAwKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuJGJ2VG9hc3QudG9hc3QoJ+acjeWKoeerr+mUmeivrycsIHsKICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn55m75b2V5aSx6LSlJywKICAgICAgICAgICAgICAgICAgICAgIGF1dG9IaWRlRGVsYXk6IDMwMDAsCiAgICAgICAgICAgICAgICAgICAgICB0b2FzdGVyOiAnYi10b2FzdGVyLXRvcC1jZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicsCiAgICAgICAgICAgICAgICAgICAgICBhcHBlbmRUb2FzdDogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfY29udGV4dC50MC5yZXNwb25zZS5zdGF0dXMgPj0gNDAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gZm9ybSB2YWxpZGF0aW9uIGVycm9yCiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZXJyb3JzID0gX2NvbnRleHQudDAucmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuJGJ2VG9hc3QudG9hc3QoX2NvbnRleHQudDAubWVzc2FnZSwgewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn55m75b2V5aSx6LSlJywKICAgICAgICAgICAgICAgICAgICBhdXRvSGlkZURlbGF5OiAzMDAwLAogICAgICAgICAgICAgICAgICAgIHRvYXN0ZXI6ICdiLXRvYXN0ZXItdG9wLWNlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogJ2RhbmdlcicsCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kVG9hc3Q6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLiRzdG9yZS5jb21taXQoJ1JFTU9WRV9BVVRIX1RPS0VOJyk7CgogICAgICAgICAgICAgICAgX3RoaXMuJHN0b3JlLmNvbW1pdCgnUkVNT1ZFX1VTRVInKTsKCiAgICAgICAgICAgICAgICBzdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgICAgICBfdGhpcy5mb3JtUHJvY2Vzc2luZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1syLCAxOV1dKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["LoginView.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"fixed-top fixed-bottom login-page\">\n        <b-row>\n            <b-col sm=\"12\" md=\"6\" lg=\"4\" offset-md=\"3\" offset-lg=\"4\">\n                <b-card class=\"p-lg-3\">\n                    <div class=\"title py-4 text-secondary\">\n                        <b-icon icon=\"x-diamond\" scale=\"3\" class=\"mr-4\" />\n                        <h4>公牛比特量化</h4>\n                    </div>\n                    <div class=\"text-center small text-secondary py-4 mb-2\">使用账号密码登录</div>\n                    <b-form @submit=\"onSubmit\">\n                        <b-alert :show=\"errors && Object.keys(errors).length > 0\" variant=\"danger\">\n                            {{ errors['non_field_errors'] && errors['non_field_errors'][0] }}\n                        </b-alert>\n                        <b-form-group>\n                            <b-input-group class=\"input-group\" size=\"lg\">\n                                <b-input-group-prepend class=\"prepend-class\">\n                                    <b-icon icon=\"person-fill\"></b-icon>\n                                </b-input-group-prepend>\n                                <b-form-input\n                                    class=\"input-class\"\n                                    v-model=\"form.username\"\n                                    type=\"text\"\n                                    placeholder=\"\"\n                                    required\n                                />\n                            </b-input-group>\n                        </b-form-group>\n                        <b-form-group>\n                            <b-input-group class=\"input-group\" size=\"lg\">\n                                <b-input-group-prepend class=\"prepend-class\">\n                                    <b-icon icon=\"key-fill\"></b-icon>\n                                </b-input-group-prepend>\n                                <b-input\n                                    class=\"input-class\"\n                                    placeholder=\"密码\"\n                                    v-model=\"form.password\"\n                                    type=\"password\"\n                                    required\n                                />\n                            </b-input-group>\n                        </b-form-group>\n                        <b-button\n                            size=\"lg\"\n                            class=\"mt-5 mb-4\"\n                            type=\"submit\"\n                            block\n                            variant=\"primary\"\n                            :disabled=\"formProcessing\"\n                            >登录</b-button\n                        >\n                    </b-form>\n                </b-card>\n            </b-col>\n        </b-row>\n    </div>\n</template>\n\n<script>\nimport { postAuthLogin } from '@/api/loginApi';\nimport storage from '../utils';\n\nexport default {\n    data() {\n        return {\n            form: {\n                username: '',\n                password: '',\n            },\n            errors: {},\n            formProcessing: false,\n        };\n    },\n    methods: {\n        login(username, password) {\n            const data = { username, password };\n            return postAuthLogin(data);\n        },\n\n        async onSubmit(event) {\n            this.formProcessing = true;\n            event.preventDefault();\n            try {\n                const loginRes = await this.login(this.form.username, this.form.password);\n                const result = loginRes.data;\n\n                const authToken = result['auth_token'];\n                this.$store.commit('SET_AUTH_TOKEN', authToken);\n                storage.saveAuthToken(authToken);\n\n                const userData = result.user;\n                const user = {\n                    userId: userData.id,\n                    username: userData.username,\n                    nickname: userData.nickname,\n                };\n                this.$store.commit('SET_USER', user);\n                storage.saveUser(user);\n\n                this.formProcessing = false;\n\n                await this.$router.push({ name: 'robot-list' });\n            } catch (error) {\n                if (error.response) {\n                    if (error.response.status >= 500) {\n                        this.$bvToast.toast('服务端错误', {\n                            title: '登录失败',\n                            autoHideDelay: 3000,\n                            toaster: 'b-toaster-top-center',\n                            variant: 'danger',\n                            appendToast: false,\n                        });\n                    } else if (error.response.status >= 400) {\n                        // form validation error\n                        this.errors = error.response.data;\n                    }\n                } else {\n                    this.$bvToast.toast(error.message, {\n                        title: '登录失败',\n                        autoHideDelay: 3000,\n                        toaster: 'b-toaster-top-center',\n                        variant: 'danger',\n                        appendToast: false,\n                    });\n                }\n                this.$store.commit('REMOVE_AUTH_TOKEN');\n                this.$store.commit('REMOVE_USER');\n                storage.clear();\n                this.formProcessing = false;\n            }\n        },\n    },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.login-page {\n    background: linear-gradient(150deg, #98aaff 0%, #0270e6 100%);\n    // background: linear-gradient(180deg, #4e73df 10%, #224abe 100%);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    .row {\n        width: 100%;\n    }\n}\n.title {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-bottom: 1px solid #eee;\n}\n.form-group {\n    margin-bottom: 2rem;\n}\n.card-body {\n    padding: 36px;\n}\n.input-group {\n    // box-shadow: 0 2px 12px rgba($color: #000000, $alpha: 0.1);\n    box-shadow: 0 1px 3px rgba(50, 50, 93, 0.15), 0 1px 0 rgba(0, 0, 0, 0.02);\n    color: #adb5bd;\n    .prepend-class {\n        width: 46px;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n    }\n    .input-class {\n        border: none;\n        font-size: 1rem;\n        line-height: 1.5;\n        color: $secondary;\n    }\n}\n</style>\n"],"sourceRoot":"src/views"}]}